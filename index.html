<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - Hendimen</title>
    <link rel="icon" type="image/png" href="https://i.imgur.com/cuIWlLe.png">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Google Fonts for smooth fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <!-- Leaflet CSS for maps -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <style>
        :root {
            --primary: #4a6bff;
            --secondary: #ff6b4a;
            --light: #f8f9fa;
            --dark: #212237;
            --success: #3ECF8E;
            --warning: #ffc107;
            --danger: #FF4B55;
            --info: #17a2b8;
            --gray: #6c757d;
            --light-gray: #e9ecef;
            --shadow-1: 0 4px 24px 0 rgba(80,114,205,0.12);
            --shadow-2: 0 8px 32px 0 rgba(80,114,205,0.20);
            --radius-card: 16px;
            --radius-btn: 8px;
            --radius-avatar: 50%;
        }
        
        /* Dark Mode Variables */
        .dark-mode {
            --primary: #5d7bff;
            --secondary: #ff7d5d;
            --light: #1a1a2e;
            --dark: #f0f0f0;
            --success: #4ed999;
            --warning: #ffd54f;
            --danger: #ff6b6b;
            --info: #4fc3f7;
            --gray: #a0a0a0;
            --light-gray: #2d2d44;
            --shadow-1: 0 4px 24px 0 rgba(0,0,0,0.3);
            --shadow-2: 0 8px 32px 0 rgba(0,0,0,0.4);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Inter', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;}
        body { background: linear-gradient(120deg, #e0e7ff 0%, #fff 100%); color: var(--dark); line-height: 1.6; overflow-x: hidden; transition: all 0.3s ease;}
        
        .dark-mode body {
            background: linear-gradient(120deg, #0f0f23 0%, #1a1a2e 100%);
            color: var(--dark);
        }
        
        .container { width: 100%; max-width: 1240px; margin: 0 auto; padding: 0 18px;}
        header { background: rgba(255,255,255,0.98); box-shadow: var(--shadow-1); position: sticky; top: 0; z-index: 100; border-bottom: 1px solid var(--light-gray); transition: all 0.3s ease;}
        
        .dark-mode header {
            background: rgba(37, 37, 64, 0.98);
            border-bottom: 1px solid #3d3d5c;
        }
        
        .navbar { display: flex; justify-content: space-between; align-items: center; padding: 18px 0;}
        .logo-img { height: 94px; width: auto; display: block; margin-right: 10px; filter: drop-shadow(0 3px 8px #b6c2ff44);}
        .logo-container { display: flex; align-items: center; }
        .mobile-menu-btn { display: none; background: none; border: none; font-size: 1.7rem; color: var(--primary); cursor: pointer;}
        .user-actions { display: flex; align-items: center; gap: 22px;}
        .role-switch { display: flex; background: #f1f4fa; border-radius: 40px; padding: 5px 6px; box-shadow: 0 2px 8px #cfd8ff22;}
        
        .dark-mode .role-switch {
            background: #2d2d44;
        }
        
        .role-btn { 
            padding: 10px 22px; border: none; border-radius: 24px; background: transparent; font-weight: 600; cursor: pointer; 
            transition: all 0.2s cubic-bezier(.68,-0.55,.27,1.55); white-space: nowrap; font-size: 1.01rem; color: var(--gray);
        }
        .role-btn.active {
            background: linear-gradient(90deg, var(--primary) 70%, #6a8aff 100%);
            color: #fff; box-shadow: 0 2px 8px #7e9eff44;
            transform: scale(1.07);
        }
        .user-profile { display: flex; align-items: center; gap: 12px;}
        .avatar {
            width: 48px; height: 48px; border-radius: var(--radius-avatar); background: linear-gradient(135deg, #4a6bff 60%, #6a8aff 100%);
            color: #fff; display: flex; align-items: center; justify-content: center; font-weight: bold; font-size: 1.2rem; box-shadow: 0 4px 18px #b6c2ff22;
            border: 2px solid #fff;
        }
        .btn {
            padding: 11px 20px; border-radius: var(--radius-btn); font-weight: 600; cursor: pointer; transition: all 0.2s; border: none; font-size: 1rem;
            letter-spacing: .02em;
        }
        .btn-primary {
            background: linear-gradient(90deg, var(--primary) 70%, #6a8aff 100%);
            color: white; box-shadow: 0 2px 12px #7e9eff22; border: 1px solid #4a6bff33;
        }
        .btn-primary:hover { background: linear-gradient(90deg, #3954d6 80%, #506be5 100%);}
        .btn-success { background: var(--success); color: white; border: 1px solid #30b770;}
        .btn-success:hover { background: #25a86a;}
        .btn-outline { background-color: transparent; border: 2px solid var(--primary); color: var(--primary);}
        .btn-outline:hover { background: var(--primary); color: #fff;}
        .dashboard { display: flex; margin-top: 35px; gap: 36px;}
        .sidebar {
            width: 252px; background: #fff; border-radius: var(--radius-card); padding: 26px; box-shadow: var(--shadow-1);
            height: fit-content; transition: transform 0.3s cubic-bezier(.77,0,.18,1.13), box-shadow 0.2s;
            border: 1.5px solid #e7ebff;
        }
        
        .dark-mode .sidebar {
            background: #252540;
            border: 1.5px solid #3d3d5c;
        }
        
        .sidebar-section { margin-bottom: 32px;}
        .sidebar-section h3 { font-size: 1.06rem; margin-bottom: 18px; color: var(--primary); text-transform: uppercase; letter-spacing: 1.2px; font-weight: 700;}
        .sidebar-menu { list-style: none;}
        .sidebar-menu li { margin-bottom: 13px;}
        .sidebar-menu a {
            display: flex; align-items: center; gap: 13px; padding: 11px 14px; text-decoration: none; color: var(--dark); border-radius: 7px;
            transition: all 0.2s cubic-bezier(.68,-0.55,.27,1.55); font-weight: 500; font-size: 1.04rem;
        }
        
        .dark-mode .sidebar-menu a {
            color: var(--dark);
        }
        
        .sidebar-menu a:hover, .sidebar-menu a.active {
            background: linear-gradient(90deg, #e5eaff 60%, #f5f7ff 100%);
            color: var(--primary); font-weight: 700;
            box-shadow: 0 2px 8px #b6c2ff22;
            transform: scale(1.03);
        }
        
        .dark-mode .sidebar-menu a:hover, 
        .dark-mode .sidebar-menu a.active {
            background: linear-gradient(90deg, #2d3560 60%, #252540 100%);
        }
        
        .sidebar-menu i { width: 22px; text-align: center;}
        .main-content { flex: 1; width: 100%;}
        .dashboard-header {
            display: flex; justify-content: space-between; align-items: center; margin-bottom: 32px; flex-wrap: wrap; gap: 18px;
            padding-bottom: 8px; border-bottom: 1px solid #e7ebff;
        }
        
        .dark-mode .dashboard-header {
            border-bottom: 1px solid #3d3d5c;
        }
        
        .dashboard-header h1 {
            font-size: 2.1rem; color: var(--primary); font-weight: 800; letter-spacing: .02em;
            background: linear-gradient(90deg, var(--primary) 70%, #6a8aff 100%);
            -webkit-background-clip: text; -webkit-text-fill-color: transparent;
        }
        .stats-cards {
            display: grid; grid-template-columns: repeat(auto-fill, minmax(225px, 1fr)); gap: 18px; margin-bottom: 36px;
        }
        .stat-card {
            background: linear-gradient(135deg, #e9f0ff 60%, #f8faff 100%);
            border-radius: var(--radius-card); padding: 26px 20px;
            box-shadow: 0 2px 12px #b6c2ff11;
            text-align: center; border: 1.5px solid #e7ebff;
            position: relative; overflow: hidden;
        }
        
        .dark-mode .stat-card {
            background: linear-gradient(135deg, #2d2d44 60%, #252540 100%);
            border: 1.5px solid #3d3d5c;
        }
        
        .stat-card::before {
            content: "";
            position: absolute; right: -32px; top: -32px;
            width: 80px; height: 80px;
            background: radial-gradient(circle, #4a6bff11 0%, transparent 75%);
            z-index: 0;
        }
        .stat-card i { font-size: 2.5rem; margin-bottom: 10px; color: var(--primary); z-index: 1; position: relative;}
        .stat-card h3 { font-size: 2.1rem; margin-bottom: 6px; font-weight: 700; letter-spacing: 0.01em;}
        .stat-card p { color: var(--gray); font-size: 1rem;}
        .filters {
            background: #fff; border-radius: var(--radius-card); padding: 22px 22px 10px 22px; margin-bottom: 28px;
            box-shadow: 0 2px 10px #a3a6ff11; border: 1.2px solid #e7ebff;
        }
        
        .dark-mode .filters {
            background: #252540;
            border: 1.2px solid #3d3d5c;
        }
        
        .filter-row { display: flex; gap: 18px; flex-wrap: wrap;}
        .filter-group { flex: 1; min-width: 155px;}
        .filter-group label { display: block; margin-bottom: 7px; font-weight: 600; color: var(--primary); font-size: 1.01rem;}
        .filter-select {
            width: 100%; padding: 11px 10px; border: 1.5px solid #d5dbff; border-radius: 7px;
            font-size: 1rem; background: #f7faff; color: var(--dark); transition: border 0.2s;
        }
        
        .dark-mode .filter-select {
            background: #2d2d44;
            border: 1.5px solid #3d3d5c;
            color: var(--dark);
        }
        
        .filter-select:focus { border-color: var(--primary); outline: none;}
        .job-list {
            display: grid; grid-template-columns: repeat(auto-fill, minmax(320px, 1fr)); gap: 23px;
        }
        .job-card {
            background: #fff; border-radius: var(--radius-card); padding: 24px 20px 18px 20px; box-shadow: var(--shadow-1); position: relative; transition: transform 0.2s, box-shadow 0.2s;
            border: 1.1px solid #e7ebff;
            overflow: hidden;
        }
        
        .dark-mode .job-card {
            background: #252540;
            border: 1.1px solid #3d3d5c;
        }
        
        .job-card:hover {
            transform: translateY(-6px) scale(1.02);
            box-shadow: var(--shadow-2);
            border-color: #b6c2ff;
        }
        .job-card.emergency {
            border-left: 7px solid var(--danger);
            background: linear-gradient(90deg, #fff 85%, #ffeaea 100%);
        }
        
        .dark-mode .job-card.emergency {
            background: linear-gradient(90deg, #252540 85%, #3d2d2d 100%);
        }
        
        .job-card h3 { margin-bottom: 12px; color: var(--dark); font-size: 1.17rem; font-weight: 700; line-height: 1.3;}
        .job-meta {
            display: flex; justify-content: space-between; margin-bottom: 11px; font-size: 1rem; color: var(--gray); flex-wrap: wrap; gap: 7px;
        }
        .job-price {
            font-weight: 700; color: var(--success); font-size: 1.19rem; margin: 12px 0 7px 0; letter-spacing: 0.01em;
            background: linear-gradient(90deg, #eafff5 60%, #fff 100%);
            border-radius: 6px; padding: 4px 0;
        }
        
        .dark-mode .job-price {
            background: linear-gradient(90deg, #1a3d2d 60%, #252540 100%);
        }
        
        .job-description {
            margin-bottom: 16px; font-size: 1.01rem; line-height: 1.6;
            display: -webkit-box; -webkit-line-clamp: 3; -webkit-box-orient: vertical; overflow: hidden; color: #324;
        }
        
        .dark-mode .job-description {
            color: var(--dark);
        }
        
        .job-tags {
            display: flex; flex-wrap: wrap; gap: 7px; margin-bottom: 15px;
        }
        .job-tag {
            background: linear-gradient(90deg, #e7eaff 60%, #f7faff 100%);
            padding: 5px 13px; border-radius: 15px; font-size: 0.93rem;
            color: var(--primary); font-weight: 600; box-shadow: 0 1px 4px #b6c2ff12;
        }
        
        .dark-mode .job-tag {
            background: linear-gradient(90deg, #2d3560 60%, #252540 100%);
        }
        
        .emergency-badge {
            background: linear-gradient(90deg, var(--danger) 70%, #ffb8b6 100%);
            color: white; padding: 4px 10px; border-radius: 7px; font-size: 0.92rem; position: absolute; top: 15px; right: 15px;
            font-weight: 800; letter-spacing: 0.04em; box-shadow: 0 1px 8px #ff4b5533;
        }
        .job-actions { display: flex; gap: 12px;}
        .job-actions .btn { flex: 1; text-align: center; padding: 10px 0; font-size: 0.97rem; }
        .requester-view .create-job-btn { display: flex; align-items: center; gap: 12px; margin-bottom: 22px;}
        .helper-view .job-card .btn { width: 100%;}
        .auth-container {
            display: flex; min-height: 100vh; align-items: center; justify-content: center;
            background: linear-gradient(135deg, #4a6bff 60%, #6a8aff 100%);
            padding: 22px;
        }
        .auth-card {
            background: #fff; border-radius: 18px; box-shadow: var(--shadow-2); width: 100%; max-width: 420px; padding: 36px 36px 28px 36px;
            border: 1.2px solid #e7ebff;
        }
        
        .dark-mode .auth-card {
            background: #252540;
            border: 1.2px solid #3d3d5c;
        }
        
        .auth-tabs { display: flex; margin-bottom: 30px; border-bottom: 1.5px solid var(--light-gray);}
        .auth-tab {
            flex: 1; text-align: center; padding: 13px 0; cursor: pointer; font-weight: 700; border-bottom: 3px solid transparent;
            font-size: 1.1rem; color: var(--gray); letter-spacing: 0.01em;
        }
        .auth-tab.active { border-bottom: 3px solid var(--primary); color: var(--primary);}
        .auth-form { display: none;}
        .auth-form.active { display: block;}
        .form-group { margin-bottom: 22px;}
        .form-group label { display: block; margin-bottom: 7px; font-weight: 600; color: var(--primary);}
        .form-control {
            width: 100%; padding: 14px 12px; border: 1.5px solid #d5dbff; border-radius: 7px; font-size: 1.01rem; background: #f7faff; color: var(--dark);
            transition: border 0.2s;
        }
        
        .dark-mode .form-control {
            background: #2d2d44;
            border: 1.5px solid #3d3d5c;
            color: var(--dark);
        }
        
        .form-control:focus { border-color: var(--primary); outline: none;}
        textarea.form-control { min-height: 100px; resize: vertical;}
        .auth-footer { text-align: center; margin-top: 24px; font-size: 0.97rem; color: var(--gray);}
        .auth-footer a { color: var(--primary); text-decoration: none; font-weight: 600;}
        .modal {
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,20,60,0.08);
            z-index: 1000; align-items: center; justify-content: center; overflow-y: auto; padding: 22px;
            backdrop-filter: blur(2.5px);
        }
        .modal-content {
            background: #fff; border-radius: var(--radius-card); width: 95%; max-width: 640px; padding: 38px 36px 24px 36px;
            position: relative; max-height: 92vh; overflow-y: auto; box-shadow: var(--shadow-2);
            border: 1.2px solid #e7ebff;
        }
        
        .dark-mode .modal-content {
            background: #252540;
            border: 1.2px solid #3d3d5c;
        }
        
        .close-modal {
            position: absolute; top: 16px; right: 16px; font-size: 1.6rem; cursor: pointer; z-index: 10; color: var(--gray);
            background: #f7faff; border-radius: 50%; padding: 3px 11px; transition: background 0.2s;
        }
        
        .dark-mode .close-modal {
            background: #2d2d44;
        }
        
        .close-modal:hover { background: #eee; color: var(--danger);}
        .modal-header { margin-bottom: 24px; padding-bottom: 13px; border-bottom: 1px solid var(--light-gray);}
        .modal-body { margin-bottom: 22px;}
        .modal-footer {
            display: flex; justify-content: flex-end; gap: 13px; padding-top: 19px; border-top: 1px solid var(--light-gray); flex-wrap: wrap;
        }
        .job-detail-item { margin-bottom: 18px;}
        .job-detail-item label { font-weight: 700; color: var(--primary); display: block; margin-bottom: 5px;}
        .job-detail-item p { font-size: 1.04rem; color: #212237;}
        
        .dark-mode .job-detail-item p {
            color: var(--dark);
        }
        
        .loading-backdrop {
            display: none; position: fixed; top:0; left:0; width:100%; height:100%;
            background: rgba(70,100,255,.11);
            z-index: 2000; align-items: center; justify-content: center;
        }
        .loading-spinner {
            border: 7px solid #f3f3f3;
            border-top: 7px solid var(--primary);
            border-radius: 50%;
            width: 74px; height: 74px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin { 100% { transform: rotate(360deg); } }
        .topup-methods {
            display: flex; flex-wrap: wrap; gap: 16px; margin-bottom: 20px;
        }
        .topup-method {
            cursor: pointer; background: var(--light-gray); border-radius: 9px; padding: 13px 21px; display: flex; align-items: center; gap: 13px;
            border: 2.5px solid transparent; transition: border .2s, background .2s; min-width: 120px; font-weight: 600; color: var(--primary); font-size: 1.03rem;
            box-shadow: 0 1px 5px #b6c2ff11;
        }
        .topup-method.selected, .topup-method:hover { border: 2.5px solid var(--primary); background: #e4ebff;}
        .topup-method img { width: 36px; height: 36px; object-fit: contain;}
        .topup-va-list { margin-top: 9px; }
        .topup-va-list select { padding: 9px; border-radius: 5px; border: 1.5px solid #b6c2ff;}
        .page { display: none;}
        .page.active { display: block;}
        .empty-state {
            text-align: center; padding: 45px 24px; background: linear-gradient(120deg, #f9faff 60%, #e9f0ff 100%);
            border-radius: var(--radius-card); box-shadow: 0 2px 10px #b6c2ff11; border: 1.2px solid #e7ebff;
        }
        
        .dark-mode .empty-state {
            background: linear-gradient(120deg, #2d2d44 60%, #252540 100%);
            border: 1.2px solid #3d3d5c;
        }
        
        .empty-state i { font-size: 3.2rem; color: var(--light-gray); margin-bottom: 18px;}
        .empty-state h3 { margin-bottom: 13px; color: var(--primary);}
        .mobile-overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(40,60,99,0.13); z-index: 99;}
        .bottom-nav {
            display: none; position: fixed; bottom: 0; left: 0; width: 100%; background: #fff;
            box-shadow: 0 -3px 18px #b6c2ff26; z-index: 90; padding: 12px 0 10px 0; border-top: 1.2px solid #e7ebff;
        }
        
        .dark-mode .bottom-nav {
            background: #252540;
            border-top: 1.2px solid #3d3d5c;
        }
        
        .bottom-nav-items { display: flex; justify-content: space-around; align-items: center;}
        .bottom-nav-item {
            display: flex; flex-direction: column; align-items: center; text-decoration: none; color: var(--gray); font-size: 0.93rem;
            padding: 5px 11px; border-radius: 9px; transition: all 0.2s; font-weight: 600;
        }
        .bottom-nav-item.active { color: var(--primary); background: #f3f5ff;}
        
        .dark-mode .bottom-nav-item.active {
            background: #2d3560;
        }
        
        .bottom-nav-item i { font-size: 1.28rem; margin-bottom: 4px;}
        .tabbed-section { margin-bottom: 28px;}
        .tabbed-menu {
            display: flex; background: var(--light-gray); border-radius: 10px; margin-bottom: 22px; overflow: hidden; box-shadow: 0 1px 4px #b6c2ff11;
        }
        .tabbed-btn {
            flex: 1; padding: 12px 0; border: none; background: none; font-weight: 700; color: var(--gray); cursor: pointer; transition: all 0.2s;
            font-size: 1.07rem; border-bottom: 2.5px solid transparent;
        }
        .tabbed-btn.active {
            background: linear-gradient(90deg, var(--primary) 70%, #6a8aff 100%);
            color: #fff; border-bottom: 2.5px solid var(--primary); box-shadow: 0 2px 8px #7e9eff22;
        }
        
        /* NEW STYLES FOR ADDED FEATURES */
        .notification-badge {
            position: absolute;
            top: -5px;
            right: -5px;
            background: var(--danger);
            color: white;
            border-radius: 50%;
            width: 18px;
            height: 18px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.7rem;
            font-weight: bold;
        }
        .notification-icon {
            position: relative;
            cursor: pointer;
        }
        .notification-dropdown {
            position: absolute;
            top: 100%;
            right: 0;
            background: white;
            border-radius: 8px;
            box-shadow: var(--shadow-2);
            width: 320px;
            max-height: 400px;
            overflow-y: auto;
            z-index: 1000;
            display: none;
        }
        
        .dark-mode .notification-dropdown {
            background: #252540;
        }
        
        .notification-item {
            padding: 12px;
            border-bottom: 1px solid var(--light-gray);
            cursor: pointer;
            transition: background 0.2s;
        }
        
        .dark-mode .notification-item {
            border-bottom: 1px solid #3d3d5c;
        }
        
        .notification-item:hover {
            background: var(--light);
        }
        
        .dark-mode .notification-item:hover {
            background: #2d2d44;
        }
        
        .notification-item.unread {
            background: #f0f7ff;
        }
        
        .dark-mode .notification-item.unread {
            background: #1a2d3d;
        }
        
        .notification-item .time {
            font-size: 0.8rem;
            color: var(--gray);
        }
        .map-container {
            height: 200px;
            border-radius: 8px;
            overflow: hidden;
            margin: 15px 0;
        }
        .rating-stars {
            color: #ffc107;
            margin: 5px 0;
        }
        .rating-input {
            display: flex;
            flex-direction: row-reverse;
            justify-content: flex-end;
        }
        .rating-input input {
            display: none;
        }
        .rating-input label {
            cursor: pointer;
            font-size: 1.5rem;
            color: #ddd;
            transition: color 0.2s;
        }
        .rating-input input:checked ~ label,
        .rating-input label:hover,
        .rating-input label:hover ~ label {
            color: #ffc107;
        }
        .search-box {
            position: relative;
            margin-bottom: 20px;
        }
        .search-box input {
            width: 100%;
            padding: 12px 40px 12px 15px;
            border: 1px solid #d5dbff;
            border-radius: 8px;
            font-size: 1rem;
        }
        
        .dark-mode .search-box input {
            background: #2d2d44;
            border: 1px solid #3d3d5c;
            color: var(--dark);
        }
        
        .search-box i {
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--gray);
        }
        .analytics-chart {
            background: white;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }
        
        .dark-mode .analytics-chart {
            background: #252540;
        }
        
        .verification-badge {
            display: inline-flex;
            align-items: center;
            background: var(--success);
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.8rem;
            margin-left: 5px;
        }
        .favorite-btn {
            background: none;
            border: none;
            color: #ddd;
            cursor: pointer;
            font-size: 1.2rem;
            transition: color 0.2s;
        }
        .favorite-btn.active {
            color: #ff6b6b;
        }
        .referral-code {
            background: linear-gradient(135deg, #e9f0ff 60%, #f8faff 100%);
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            margin: 15px 0;
        }
        
        .dark-mode .referral-code {
            background: linear-gradient(135deg, #2d2d44 60%, #252540 100%);
        }
        
        .referral-code .code {
            font-size: 1.5rem;
            font-weight: bold;
            letter-spacing: 2px;
            margin: 10px 0;
        }
        .dark-mode-toggle {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: var(--primary);
            color: white;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
            z-index: 100;
        }
        
        .schedule-reminder {
            background: linear-gradient(135deg, #fff9e6 60%, #fff 100%);
            border-left: 4px solid var(--warning);
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
        }
        
        .dark-mode .schedule-reminder {
            background: linear-gradient(135deg, #2d2a1a 60%, #252540 100%);
        }
        
        /* Responsive Design */
        @media (max-width: 1160px) {
            .dashboard { gap: 22px;}
            .sidebar { padding: 16px;}
            .main-content { padding-left: 0;}
        }
        @media (max-width: 992px) {
            .dashboard { flex-direction: column; gap: 22px;}
            .sidebar {
                width: 100%; position: fixed; top: 76px; left: 0; height: calc(100vh - 76px); z-index: 100; overflow-y: auto; transform: translateX(-100%);
                box-shadow: var(--shadow-2); border-radius: 0 16px 16px 0;
            }
            .sidebar.mobile-visible { transform: translateX(0);}
            .main-content { margin-left: 0;}
            .mobile-menu-btn { display: block;}
            .user-profile span { display: none;}
            .notification-dropdown {
                width: 280px;
                right: -50px;
            }
        }
        @media (max-width: 768px) {
            .navbar { padding: 11px 0;}
            .user-actions { gap: 13px;}
            .role-switch { padding: 4px;}
            .role-btn { padding: 7px 13px; font-size: 0.92rem;}
            .dashboard { margin-top: 17px;}
            .dashboard-header { flex-direction: column; align-items: flex-start;}
            .dashboard-header h1 { font-size: 1.4rem;}
            .stats-cards { grid-template-columns: 1fr 1fr; gap: 10px;}
            .stat-card { padding: 14px;}
            .stat-card i { font-size: 1.3rem;}
            .stat-card h3 { font-size: 1.3rem;}
            .filters { padding: 13px;}
            .filter-row { gap: 8px;}
            .filter-group { min-width: 110px;}
            .job-list { grid-template-columns: 1fr; gap: 13px;}
            .job-card { padding: 13px;}
            .job-actions { flex-direction: column;}
            .bottom-nav { display: block;}
            .modal-content { padding: 18px;}
            .modal-footer { flex-direction: column;}
            .modal-footer .btn { width: 100%; margin-bottom: 11px;}
            .logo-img { height: 54px;}
            .auth-card { padding: 17px;}
            .notification-dropdown {
                width: 250px;
                right: -80px;
            }
        }
        @media (max-width: 520px) {
            .container { padding: 0 7px;}
            .logo-img { height: 37px;}
            .stats-cards { grid-template-columns: 1fr;}
            .role-switch { flex-direction: column; background: transparent; gap: 5px;}
            .role-btn { border-radius: 6px; background: #f3f5ff;}
            .user-actions { flex-direction: column; align-items: flex-end; gap: 7px;}
            .auth-card { padding: 10px;}
            .job-meta { flex-direction: column;}
            .sidebar { padding: 5px;}
            .dashboard-header { padding-bottom: 4px;}
            .notification-dropdown {
                width: 200px;
                right: -100px;
            }
        }
        @media (max-width: 370px) {
            .dashboard-header h1 { font-size: 1.08rem;}
            .btn { padding: 7px 10px; font-size: 0.82rem;}
            .job-card h3 { font-size: 0.98rem;}
            .job-price { font-size: 0.98rem;}
            .notification-dropdown {
                width: 180px;
                right: -120px;
            }
        }
    </style>
</head>
<body>
    <!-- Loading Backdrop -->
    <div class="loading-backdrop" id="loadingBackdrop">
        <div class="loading-spinner"></div>
    </div>
    
    <!-- Auth Pages -->
    <div id="authPage" class="page active">
        <div class="auth-container">
            <div class="auth-card">
                <div class="auth-tabs">
                    <div class="auth-tab active" onclick="switchAuthTab('login')">Masuk</div>
                    <div class="auth-tab" onclick="switchAuthTab('register')">Daftar</div>
                </div>
                <form id="loginForm" class="auth-form active" autocomplete="off">
                    <div class="form-group">
                        <label for="loginEmail">Email atau Nomor Telepon</label>
                        <input type="text" id="loginEmail" class="form-control" required autocomplete="off">
                    </div>
                    <div class="form-group">
                        <label for="loginPassword">Kata Sandi</label>
                        <input type="password" id="loginPassword" class="form-control" required autocomplete="off">
                    </div>
                    <button type="submit" class="btn btn-primary" style="width: 100%;">Masuk</button>
                    <div class="auth-footer">
                        <a href="#">Lupa kata sandi?</a>
                    </div>
                </form>
                <form id="registerForm" class="auth-form" autocomplete="off">
                    <div class="form-group">
                        <label for="userType">Saya ingin mendaftar sebagai:</label>
                        <select id="userType" class="form-control">
                            <option value="helper">Helper (Siap Membantu)</option>
                            <option value="requester">Requester (Butuh Bantuan)</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="regName">Nama Lengkap</label>
                        <input type="text" id="regName" class="form-control" required autocomplete="off">
                    </div>
                    <div class="form-group">
                        <label for="regEmail">Email</label>
                        <input type="email" id="regEmail" class="form-control" required autocomplete="off">
                    </div>
                    <div class="form-group">
                        <label for="regPhone">Nomor Telepon</label>
                        <input type="tel" id="regPhone" class="form-control" required autocomplete="off">
                    </div>
                    <div class="form-group">
                        <label for="regPassword">Kata Sandi</label>
                        <input type="password" id="regPassword" class="form-control" required autocomplete="off">
                    </div>
                    <div class="form-group">
                        <label for="regConfirmPassword">Konfirmasi Kata Sandi</label>
                        <input type="password" id="regConfirmPassword" class="form-control" required autocomplete="off">
                    </div>
                    <div class="form-group">
                        <label for="regId">Upload KTP/SIM/KTM</label>
                        <input type="file" id="regId" class="form-control">
                        <small>Verifikasi identitas diperlukan untuk keamanan platform</small>
                    </div>
                    <button type="submit" class="btn btn-primary" style="width: 100%;">Daftar</button>
                    <div class="auth-footer">
                        Dengan mendaftar, Anda menyetujui <a href="#">Syarat & Ketentuan</a> kami
                    </div>
                </form>
            </div>
        </div>
    </div>
    
    <!-- Dashboard Page -->
    <div id="dashboardPage" class="page">
        <header>
            <div class="container">
                <nav class="navbar">
                    <button class="mobile-menu-btn" id="mobileMenuBtn">
                        <i class="fas fa-bars"></i>
                    </button>
                    <div class="logo-container">
                        <img src="https://i.imgur.com/cuIWlLe.png" class="logo-img" alt="Hendimen Logo">
                    </div>
                    <div class="user-actions">
                        <div class="role-switch">
                            <button class="role-btn active" id="requesterBtn">Requester</button>
                            <button class="role-btn" id="helperBtn">Helper</button>
                        </div>
                        <div class="notification-icon" id="notificationIcon">
                            <i class="fas fa-bell"></i>
                            <div class="notification-badge" id="notificationBadge">3</div>
                            <div class="notification-dropdown" id="notificationDropdown">
                                <div class="notification-item unread">
                                    <div><strong>Pekerjaan Baru</strong></div>
                                    <div>Ada pekerjaan pindahan di daerah Payung Sekaki</div>
                                    <div class="time">5 menit lalu</div>
                                </div>
                                <div class="notification-item unread">
                                    <div><strong>Pembayaran Diterima</strong></div>
                                    <div>Pembayaran untuk pekerjaan #123 telah diterima</div>
                                    <div class="time">1 jam lalu</div>
                                </div>
                                <div class="notification-item">
                                    <div><strong>Rating Baru</strong></div>
                                    <div>Anda mendapat rating 5 bintang dari Budi</div>
                                    <div class="time">2 hari lalu</div>
                                </div>
                            </div>
                        </div>
                        <div class="user-profile">
                            <div class="avatar" id="profileAvatar">AS</div>
                            <span id="profileName">Ahmad Surya</span>
                            <button class="btn btn-outline" onclick="logout()">Keluar</button>
                        </div>
                    </div>
                </nav>
            </div>
        </header>
        <div class="mobile-overlay" id="mobileOverlay"></div>
        <div class="container">
            <div class="dashboard">
                <div class="sidebar" id="sidebar">
                    <div class="sidebar-section">
                        <h3>Menu Utama</h3>
                        <ul class="sidebar-menu">
                            <li><a href="#" class="sidebar-link active" data-page="homePage"><i class="fas fa-home"></i> Beranda</a></li>
                            <li><a href="#" class="sidebar-link" data-page="jobsPage"><i class="fas fa-briefcase"></i> Pekerjaan Saya</a></li>
                            <li><a href="#" class="sidebar-link" data-page="messagesPage"><i class="fas fa-comments"></i> Pesan <span class="notification-badge">2</span></a></li>
                            <li><a href="#" class="sidebar-link" data-page="walletPage"><i class="fas fa-wallet"></i> Dompet Saya</a></li>
                            <li><a href="#" class="sidebar-link" data-page="ratingPage"><i class="fas fa-star"></i> Rating &amp; Ulasan</a></li>
                            <li><a href="#" class="sidebar-link" data-page="historyPage"><i class="fas fa-history"></i> Riwayat</a></li>
                            <li><a href="#" class="sidebar-link helper-only" data-page="analyticsPage"><i class="fas fa-chart-line"></i> Analitik</a></li>
                            <li><a href="#" class="sidebar-link" data-page="settingsPage"><i class="fas fa-cog"></i> Pengaturan</a></li>
                        </ul>
                    </div>
                    <div class="sidebar-section">
                        <h3>Kategori</h3>
                        <ul class="sidebar-menu">
                            <li><a href="#" class="cat-link" data-cat="moving"><i class="fas fa-truck-moving"></i> Pindahan</a></li>
                            <li><a href="#" class="cat-link" data-cat="transport"><i class="fas fa-car"></i> Antar Jemput</a></li>
                            <li><a href="#" class="cat-link" data-cat="delivery"><i class="fas fa-box"></i> Pengiriman</a></li>
                            <li><a href="#" class="cat-link" data-cat="tools"><i class="fas fa-tools"></i> Perbaikan</a></li>
                            <li><a href="#" class="cat-link" data-cat="event"><i class="fas fa-user-friends"></i> Jaga Acara</a></li>
                            <li><a href="#" class="cat-link" data-cat="other"><i class="fas fa-ellipsis-h"></i> Lainnya</a></li>
                        </ul>
                    </div>
                    <div class="sidebar-section">
                        <h3>Fitur Lainnya</h3>
                        <ul class="sidebar-menu">
                            <li><a href="#" class="sidebar-link" data-page="favoritesPage"><i class="fas fa-heart"></i> Favorit</a></li>
                            <li><a href="#" class="sidebar-link" data-page="referralPage"><i class="fas fa-gift"></i> Program Referral</a></li>
                        </ul>
                    </div>
                </div>
                <div class="main-content">
                    <!-- Halaman Beranda -->
                    <div id="homePage" class="tabbed-section page-main active">
                        <!-- Requester View -->
                        <div class="requester-view" id="requesterView">
                            <div class="dashboard-header">
                                <h1>Beranda Requester</h1>
                                <div>
                                    <button class="btn btn-primary" onclick="openModal('createJobModal')">
                                        <i class="fas fa-plus"></i> Buat Permintaan Bantuan
                                    </button>
                                </div>
                            </div>
                            
                            <!-- Schedule Reminder -->
                            <div class="schedule-reminder">
                                <div><i class="fas fa-clock"></i> <strong>Pengingat Jadwal</strong></div>
                                <div>Anda memiliki 2 pekerjaan aktif yang perlu dipantau</div>
                            </div>
                            
                            <div class="stats-cards">
                                <div class="stat-card"><i class="fas fa-bell"></i><h3 id="activeJobsCount">0</h3><p>Permintaan Aktif</p></div>
                                <div class="stat-card"><i class="fas fa-check-circle"></i><h3>12</h3><p>Selesai</p></div>
                                <div class="stat-card"><i class="fas fa-star"></i><h3>4.8</h3><p>Rating Rata-rata</p></div>
                                <div class="stat-card"><i class="fas fa-wallet"></i><h3>Rp 850K</h3><p>Total Dibayarkan</p></div>
                            </div>
                            
                            <!-- Search Box -->
                            <div class="search-box">
                                <input type="text" id="homeSearch" placeholder="Cari pekerjaan, lokasi, atau kategori...">
                                <i class="fas fa-search"></i>
                            </div>
                            
                            <div class="filters">
                                <div class="filter-row">
                                    <div class="filter-group">
                                        <label for="categoryFilter">Kategori</label>
                                        <select id="categoryFilter" class="filter-select" onchange="filterJobs()">
                                            <option value="all">Semua Kategori</option>
                                            <option value="moving">Pindahan</option>
                                            <option value="delivery">Pengiriman</option>
                                            <option value="transport">Antar Jemput</option>
                                            <option value="event">Jaga Acara</option>
                                        </select>
                                    </div>
                                    <div class="filter-group">
                                        <label for="statusFilter">Status</label>
                                        <select id="statusFilter" class="filter-select" onchange="filterJobs()">
                                            <option value="all">Semua Status</option>
                                            <option value="open">Terbuka</option>
                                            <option value="in-progress">Dalam Proses</option>
                                            <option value="completed">Selesai</option>
                                        </select>
                                    </div>
                                    <div class="filter-group">
                                        <label for="sortFilter">Urutkan</label>
                                        <select id="sortFilter" class="filter-select" onchange="filterJobs()">
                                            <option value="newest">Terbaru</option>
                                            <option value="oldest">Terlama</option>
                                            <option value="price-high">Harga Tertinggi</option>
                                            <option value="price-low">Harga Terendah</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                            <div id="requesterJobList" class="job-list"></div>
                        </div>
                        
                        <!-- Helper View -->
                        <div class="helper-view" id="helperView" style="display: none;">
                            <div class="dashboard-header">
                                <h1>Beranda Helper</h1>
                                <div class="location-info"><i class="fas fa-map-marker-alt"></i> Pekanbaru, Riau</div>
                            </div>
                            
                            <!-- Schedule Reminder -->
                            <div class="schedule-reminder">
                                <div><i class="fas fa-clock"></i> <strong>Pengingat Jadwal</strong></div>
                                <div>Anda memiliki 3 pekerjaan aktif hari ini</div>
                            </div>
                            
                            <div class="stats-cards">
                                <div class="stat-card"><i class="fas fa-briefcase"></i><h3>8</h3><p>Pekerjaan Aktif</p></div>
                                <div class="stat-card"><i class="fas fa-check-circle"></i><h3>24</h3><p>Selesai</p></div>
                                <div class="stat-card"><i class="fas fa-star"></i><h3>4.9</h3><p>Rating Anda</p></div>
                                <div class="stat-card"><i class="fas fa-wallet"></i><h3>Rp 2.1JT</h3><p>Pendapatan Bulan Ini</p></div>
                            </div>
                            
                            <!-- Search Box -->
                            <div class="search-box">
                                <input type="text" id="helperSearch" placeholder="Cari pekerjaan, lokasi, atau kategori...">
                                <i class="fas fa-search"></i>
                            </div>
                            
                            <div class="filters">
                                <div class="filter-row">
                                    <div class="filter-group">
                                        <label for="helperCategoryFilter">Kategori</label>
                                        <select id="helperCategoryFilter" class="filter-select" onchange="filterHelperJobs()">
                                            <option value="all">Semua Kategori</option>
                                            <option value="moving">Pindahan</option>
                                            <option value="delivery">Pengiriman</option>
                                            <option value="transport">Antar Jemput</option>
                                            <option value="event">Jaga Acara</option>
                                        </select>
                                    </div>
                                    <div class="filter-group">
                                        <label for="distanceFilter">Jarak</label>
                                        <select id="distanceFilter" class="filter-select" onchange="filterHelperJobs()">
                                            <option value="all">Semua Jarak</option>
                                            <option value="1km">≤ 1 km</option>
                                            <option value="5km">≤ 5 km</option>
                                            <option value="10km">≤ 10 km</option>
                                        </select>
                                    </div>
                                    <div class="filter-group">
                                        <label for="helperSortFilter">Urutkan</label>
                                        <select id="helperSortFilter" class="filter-select" onchange="filterHelperJobs()">
                                            <option value="newest">Terbaru</option>
                                            <option value="price-high">Harga Tertinggi</option>
                                            <option value="price-low">Harga Terendah</option>
                                            <option value="distance">Terdekat</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                            <div id="helperJobList" class="job-list"></div>
                        </div>
                    </div>
                    
                    <!-- Halaman Pekerjaan Saya -->
                    <div id="jobsPage" class="tabbed-section page-main" style="display:none;">
                        <div class="dashboard-header">
                            <h1>Pekerjaan Saya</h1>
                        </div>
                        <div class="tabbed-menu" style="margin-bottom:20px;">
                            <button class="tabbed-btn active" data-tab="activeJobsTab" onclick="switchTab('activeJobsTab', this)">Aktif</button>
                            <button class="tabbed-btn" data-tab="completedJobsTab" onclick="switchTab('completedJobsTab', this)">Selesai</button>
                            <button class="tabbed-btn" data-tab="favoriteJobsTab" onclick="switchTab('favoriteJobsTab', this)">Favorit</button>
                        </div>
                        <!-- Tab Aktif -->
                        <div id="activeJobsTab" class="tab-page">
                            <div class="filters">
                                <div class="filter-row">
                                    <div class="filter-group">
                                        <label for="myJobSearch">Cari Pekerjaan</label>
                                        <input id="myJobSearch" class="form-control" type="text" placeholder="Judul pekerjaan..." oninput="filterMyJobs()">
                                    </div>
                                </div>
                            </div>
                            <div id="activeJobList" class="job-list"></div>
                        </div>
                        <!-- Tab Selesai -->
                        <div id="completedJobsTab" class="tab-page" style="display:none;">
                            <div class="filters">
                                <div class="filter-row">
                                    <div class="filter-group">
                                        <label for="myJobDoneSearch">Cari Pekerjaan Selesai</label>
                                        <input id="myJobDoneSearch" class="form-control" type="text" placeholder="Judul pekerjaan..." oninput="filterMyJobs()">
                                    </div>
                                </div>
                            </div>
                            <div id="completedJobList" class="job-list"></div>
                        </div>
                        <!-- Tab Favorit -->
                        <div id="favoriteJobsTab" class="tab-page" style="display:none;">
                            <div id="favoriteJobList" class="job-list"></div>
                        </div>
                    </div>
                    
                    <!-- Halaman Pesan -->
                    <div id="messagesPage" class="tabbed-section page-main" style="display:none;">
                        <div class="dashboard-header">
                            <h1>Pesan</h1>
                        </div>
                        <div class="empty-state">
                            <i class="fas fa-comments"></i>
                            <h3>Fitur Pesan</h3>
                            <p>Fitur pesan real-time akan segera hadir untuk memudahkan komunikasi antara requester dan helper.</p>
                        </div>
                    </div>
                    
                    <!-- Halaman Dompet -->
                    <div id="walletPage" class="tabbed-section page-main" style="display:none;">
                        <div class="dashboard-header">
                            <h1>Dompet Saya</h1>
                        </div>
                        <div style="background:#fff; border-radius:8px; padding:24px 24px 10px 24px;margin-bottom:18px; box-shadow:0 2px 10px rgba(0,0,0,0.05);" class="dark-mode-bg">
                            <div style="font-size:1.2rem;color:var(--gray);margin-bottom:7px;">Saldo Tersedia</div>
                            <div style="font-size:2.2rem;font-weight:700;color:var(--primary);margin-bottom:15px;" id="walletBalance">Rp 1.250.000</div>
                            <button class="btn btn-success" onclick="openModal('topupModal')"><i class="fas fa-plus"></i> Top Up</button>
                            <button class="btn btn-outline" onclick="alert('Fitur tarik saldo akan segera hadir!')"><i class="fas fa-arrow-down"></i> Tarik Saldo</button>
                        </div>
                        <div style="margin-bottom:10px;font-weight:600;font-size:1.1rem;">Riwayat Transaksi</div>
                        <div style="background:#fff; border-radius:8px; box-shadow:0 2px 10px rgba(0,0,0,0.05);padding:16px;" class="dark-mode-bg">
                            <table style="width:100%;border-collapse:collapse;">
                                <thead>
                                    <tr style="background:var(--light-gray);">
                                        <th style="text-align:left;padding:10px;">Tanggal</th>
                                        <th style="text-align:left;">Deskripsi</th>
                                        <th style="text-align:right;">Jumlah</th>
                                        <th style="text-align:right;">Status</th>
                                    </tr>
                                </thead>
                                <tbody id="walletHistory">
                                    <!-- Riwayat dummy akan diisi JS -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                    
                    <!-- Halaman Rating & Ulasan -->
                    <div id="ratingPage" class="tabbed-section page-main" style="display:none;">
                        <div class="dashboard-header">
                            <h1>Rating &amp; Ulasan</h1>
                        </div>
                        <div class="stats-cards" style="margin-bottom:20px;">
                            <div class="stat-card">
                                <i class="fas fa-star"></i>
                                <h3>4.8</h3>
                                <p>Rating Rata-rata</p>
                            </div>
                            <div class="stat-card">
                                <i class="fas fa-users"></i>
                                <h3>45</h3>
                                <p>Total Ulasan</p>
                            </div>
                            <div class="stat-card">
                                <i class="fas fa-thumbs-up"></i>
                                <h3>92%</h3>
                                <p>Kepuasan Pengguna</p>
                            </div>
                        </div>
                        <div style="background:#fff; border-radius:8px; box-shadow:0 2px 10px rgba(0,0,0,0.05);padding:20px;" class="dark-mode-bg">
                            <div style="font-weight:600;font-size:1.1rem;margin-bottom:10px;">Ulasan Pengguna</div>
                            <div id="reviewList">
                                <!-- Dummy ulasan akan diisi JS -->
                            </div>
                        </div>
                    </div>
                    
                    <!-- Halaman Riwayat -->
                    <div id="historyPage" class="tabbed-section page-main" style="display:none;">
                        <div class="dashboard-header">
                            <h1>Riwayat Pekerjaan</h1>
                        </div>
                        <div class="filters">
                            <div class="filter-row">
                                <div class="filter-group">
                                    <label for="historySearch">Cari Riwayat</label>
                                    <input id="historySearch" class="form-control" type="text" placeholder="Judul atau lokasi..." oninput="filterHistory()">
                                </div>
                                <div class="filter-group">
                                    <label for="historySort">Urutkan</label>
                                    <select id="historySort" class="filter-select" onchange="filterHistory()">
                                        <option value="newest">Terbaru</option>
                                        <option value="oldest">Terlama</option>
                                        <option value="price-high">Harga Tertinggi</option>
                                        <option value="price-low">Harga Terendah</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        <div id="historyList" class="job-list"></div>
                    </div>
                    
                    <!-- Halaman Analitik (Hanya untuk Helper) -->
                    <div id="analyticsPage" class="tabbed-section page-main" style="display:none;">
                        <div class="dashboard-header">
                            <h1>Analitik & Statistik</h1>
                        </div>
                        <div class="stats-cards" style="margin-bottom:20px;">
                            <div class="stat-card">
                                <i class="fas fa-chart-line"></i>
                                <h3>24</h3>
                                <p>Pekerjaan/Bulan</p>
                            </div>
                            <div class="stat-card">
                                <i class="fas fa-money-bill-wave"></i>
                                <h3>Rp 2.1JT</h3>
                                <p>Pendapatan/Bulan</p>
                            </div>
                            <div class="stat-card">
                                <i class="fas fa-clock"></i>
                                <h3>3.2</h3>
                                <p>Jam/Pekerjaan</p>
                            </div>
                            <div class="stat-card">
                                <i class="fas fa-map-marker-alt"></i>
                                <h3>5km</h3>
                                <p>Jarak Rata-rata</p>
                            </div>
                        </div>
                        <div class="analytics-chart">
                            <h3 style="margin-bottom:15px;">Grafik Pendapatan Bulanan</h3>
                            <div style="height:200px;background:#f5f5f5;border-radius:8px;display:flex;align-items:flex-end;padding:10px;" class="dark-mode-bg">
                                <div style="flex:1;display:flex;flex-direction:column;align-items:center;">
                                    <div style="background:var(--primary);width:80%;height:150px;border-radius:4px;"></div>
                                    <div style="margin-top:5px;">Jan</div>
                                </div>
                                <div style="flex:1;display:flex;flex-direction:column;align-items:center;">
                                    <div style="background:var(--primary);width:70%;height:130px;border-radius:4px;"></div>
                                    <div style="margin-top:5px;">Feb</div>
                                </div>
                                <div style="flex:1;display:flex;flex-direction:column;align-items:center;">
                                    <div style="background:var(--primary);width:90%;height:170px;border-radius:4px;"></div>
                                    <div style="margin-top:5px;">Mar</div>
                                </div>
                                <div style="flex:1;display:flex;flex-direction:column;align-items:center;">
                                    <div style="background:var(--primary);width:85%;height:160px;border-radius:4px;"></div>
                                    <div style="margin-top:5px;">Apr</div>
                                </div>
                                <div style="flex:1;display:flex;flex-direction:column;align-items:center;">
                                    <div style="background:var(--primary);width:95%;height:180px;border-radius:4px;"></div>
                                    <div style="margin-top:5px;">Mei</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Halaman Favorit -->
                    <div id="favoritesPage" class="tabbed-section page-main" style="display:none;">
                        <div class="dashboard-header">
                            <h1>Pekerjaan Favorit</h1>
                        </div>
                        <div id="favoritesList" class="job-list">
                            <div class="empty-state">
                                <i class="fas fa-heart"></i>
                                <h3>Belum ada pekerjaan favorit</h3>
                                <p>Simpan pekerjaan yang menarik dengan menekan ikon hati pada kartu pekerjaan.</p>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Halaman Referral -->
                    <div id="referralPage" class="tabbed-section page-main" style="display:none;">
                        <div class="dashboard-header">
                            <h1>Program Referral</h1>
                        </div>
                        <div class="referral-code">
                            <h3>Bagikan kode referral Anda</h3>
                            <div class="code">HENDI123</div>
                            <p>Dapatkan Rp 50.000 untuk setiap teman yang bergabung menggunakan kode Anda</p>
                            <button class="btn btn-primary" onclick="copyReferralCode()">Salin Kode</button>
                        </div>
                        <div style="background:#fff; border-radius:8px; box-shadow:0 2px 10px rgba(0,0,0,0.05);padding:20px;margin-top:20px;" class="dark-mode-bg">
                            <h3 style="margin-bottom:15px;">Riwayat Referral</h3>
                            <div class="empty-state" style="padding:20px;">
                                <i class="fas fa-users"></i>
                                <h3>Belum ada referral</h3>
                                <p>Bagikan kode referral Anda kepada teman-teman untuk mendapatkan bonus.</p>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Halaman Pengaturan -->
                    <div id="settingsPage" class="tabbed-section page-main" style="display:none;">
                        <div class="dashboard-header">
                            <h1>Pengaturan Akun</h1>
                        </div>
                        <div style="background:#fff; border-radius:8px; box-shadow:0 2px 10px rgba(0,0,0,0.05);padding:24px 22px 18px 22px;margin-bottom:20px;" class="dark-mode-bg">
                            <div class="form-group" style="margin-bottom:18px;">
                                <label>Notifikasi</label>
                                <div>
                                    <input type="checkbox" id="notifJob" checked> Notifikasi pekerjaan baru
                                </div>
                                <div>
                                    <input type="checkbox" id="notifPromo"> Notifikasi promo &amp; update
                                </div>
                                <div>
                                    <input type="checkbox" id="notifMessage" checked> Notifikasi pesan
                                </div>
                            </div>
                            <div class="form-group" style="margin-bottom:18px;">
                                <label>Verifikasi Identitas</label>
                                <div>
                                    <span>Status: </span>
                                    <span class="verification-badge"><i class="fas fa-check"></i> Terverifikasi</span>
                                </div>
                                <small>Akun Anda telah terverifikasi dan dapat menggunakan semua fitur platform.</small>
                            </div>
                            <div class="form-group" style="margin-bottom:18px;">
                                <label>Mode Tampilan</label>
                                <div>
                                    <input type="checkbox" id="darkModeToggle" onchange="toggleDarkMode()"> Mode Gelap
                                </div>
                            </div>
                        </div>
                        <div style="margin-top:18px;">
                            <button class="btn btn-outline" onclick="logout()"><i class="fas fa-sign-out-alt"></i> Keluar Akun</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Bottom Navigation for Mobile -->
        <div class="bottom-nav">
            <div class="bottom-nav-items">
                <a href="#" class="bottom-nav-item active" data-page="homePage">
                    <i class="fas fa-home"></i>
                    <span>Beranda</span>
                </a>
                <a href="#" class="bottom-nav-item" data-page="jobsPage">
                    <i class="fas fa-briefcase"></i>
                    <span>Pekerjaan</span>
                </a>
                <a href="#" class="bottom-nav-item" data-page="messagesPage">
                    <i class="fas fa-comments"></i>
                    <span>Pesan</span>
                </a>
                <a href="#" class="bottom-nav-item" data-page="walletPage">
                    <i class="fas fa-wallet"></i>
                    <span>Dompet</span>
                </a>
                <a href="#" class="bottom-nav-item" data-page="ratingPage">
                    <i class="fas fa-star"></i>
                    <span>Ulasan</span>
                </a>
                <a href="#" class="bottom-nav-item helper-only" data-page="analyticsPage">
                    <i class="fas fa-chart-line"></i>
                    <span>Analitik</span>
                </a>
            </div>
        </div>
        
        <!-- Dark Mode Toggle Button -->
        <div class="dark-mode-toggle" onclick="toggleDarkMode()">
            <i class="fas fa-moon"></i>
        </div>
    </div>
    
    <!-- Modal Top Up -->
    <div id="topupModal" class="modal">
        <div class="modal-content">
            <span class="close-modal" onclick="closeModal('topupModal')">&times;</span>
            <h2>Top Up Saldo</h2>
            <form id="topupForm">
                <div class="form-group">
                    <label>Metode Top Up</label>
                    <div class="topup-methods">
                        <div class="topup-method" data-method="dana"><img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRHbelUsAOasaznlczskMkFd2hgtFHaBt_aBw&s" alt="DANA">DANA</div>
                        <div class="topup-method" data-method="shopeepay"><img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTnQ54gdjaHKfhtVWT3C1n-gLZljKqucGLOeg&s" alt="ShopeePay">ShopeePay</div>
                        <div class="topup-method" data-method="qris"><img src="https://i.imgur.com/JmfTHcd.png" alt="QRIS">QRIS</div>
                        <div class="topup-method" data-method="va">Virtual Account</div>
                    </div>
                    <div class="topup-va-list" id="topupVALIST" style="display:none;">
                        <label for="vaBank">Pilih Bank:</label>
                        <select id="vaBank">
                            <option value="bca">BCA</option>
                            <option value="bri">BRI</option>
                            <option value="bni">BNI</option>
                            <option value="mandiri">Mandiri</option>
                            <option value="permata">Permata</option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label for="topupNominal">Nominal Top Up (Rp)</label>
                    <input type="number" id="topupNominal" class="form-control" required min="10000" step="10000" placeholder="Minimal 10.000">
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-outline" onclick="closeModal('topupModal')">Batal</button>
                    <button type="submit" class="btn btn-primary">Lanjutkan Top Up</button>
                </div>
            </form>
        </div>
    </div>
    
    <!-- Create Job Modal -->
    <div id="createJobModal" class="modal">
        <div class="modal-content">
            <span class="close-modal" onclick="closeModal('createJobModal')">&times;</span>
            <h2>Buat Permintaan Bantuan Baru</h2>
            <form id="createJobForm">
                <div class="form-group">
                    <label for="jobTitle">Judul Pekerjaan</label>
                    <input type="text" id="jobTitle" class="form-control" placeholder="Contoh: Butuh bantuan pindah barang" required>
                </div>
                <div class="form-group">
                    <label for="jobCategory">Kategori</label>
                    <select id="jobCategory" class="form-control" required>
                        <option value="">Pilih Kategori</option>
                        <option value="moving">Pindahan</option>
                        <option value="delivery">Pengiriman</option>
                        <option value="transport">Antar Jemput</option>
                        <option value="event">Jaga Acara</option>
                        <option value="other">Lainnya</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="jobDescription">Deskripsi Pekerjaan</label>
                    <textarea id="jobDescription" class="form-control" placeholder="Jelaskan detail pekerjaan yang dibutuhkan" required></textarea>
                </div>
                <div class="form-group">
                    <label for="jobLocation">Lokasi</label>
                    <input type="text" id="jobLocation" class="form-control" placeholder="Alamat lengkap" required>
                </div>
                <div class="form-group">
                    <label for="jobPrice">Upah yang Ditawarkan (Rp)</label>
                    <input type="number" id="jobPrice" class="form-control" placeholder="Contoh: 75000" required>
                </div>
                <div class="form-group">
                    <label>
                        <input type="checkbox" id="emergencyJob"> Tandai sebagai kebutuhan emergency (upah akan ditingkatkan 25%)
                    </label>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-outline" onclick="closeModal('createJobModal')">Batal</button>
                    <button type="submit" class="btn btn-primary">Posting Permintaan</button>
                </div>
            </form>
        </div>
    </div>
    
    <!-- Job Detail Modal -->
    <div id="jobDetailModal" class="modal">
        <div class="modal-content">
            <span class="close-modal" onclick="closeModal('jobDetailModal')">&times;</span>
            <div class="modal-header">
                <h2 id="detailJobTitle">Judul Pekerjaan</h2>
                <div id="detailJobBadge"></div>
            </div>
            <div class="modal-body">
                <div class="job-detail-item">
                    <label>Kategori</label>
                    <p id="detailJobCategory">-</p>
                </div>
                <div class="job-detail-item">
                    <label>Lokasi</label>
                    <p id="detailJobLocation">-</p>
                    <div class="map-container" id="detailJobMap">
                        <!-- Peta akan ditampilkan di sini -->
                    </div>
                </div>
                <div class="job-detail-item">
                    <label>Upah</label>
                    <p id="detailJobPrice" class="job-price">-</p>
                </div>
                <div class="job-detail-item">
                    <label>Deskripsi</label>
                    <p id="detailJobDescription">-</p>
                </div>
                <div class="job-detail-item">
                    <label>Dibuat pada</label>
                    <p id="detailJobDate">-</p>
                </div>
                <div class="job-detail-item">
                    <label>Status</label>
                    <p id="detailJobStatus">-</p>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-outline" onclick="closeModal('jobDetailModal')">Tutup</button>
                <button type="button" class="btn btn-primary" id="detailActionBtn">Ambil Pekerjaan</button>
                <button type="button" class="btn btn-outline favorite-btn" id="detailFavoriteBtn"><i class="far fa-heart"></i></button>
            </div>
        </div>
    </div>
    
    <!-- Rating Modal -->
    <div id="ratingModal" class="modal">
        <div class="modal-content">
            <span class="close-modal" onclick="closeModal('ratingModal')">&times;</span>
            <h2>Beri Rating & Ulasan</h2>
            <form id="ratingForm">
                <div class="form-group">
                    <label>Rating</label>
                    <div class="rating-input">
                        <input type="radio" id="star5" name="rating" value="5">
                        <label for="star5">★</label>
                        <input type="radio" id="star4" name="rating" value="4">
                        <label for="star4">★</label>
                        <input type="radio" id="star3" name="rating" value="3">
                        <label for="star3">★</label>
                        <input type="radio" id="star2" name="rating" value="2">
                        <label for="star2">★</label>
                        <input type="radio" id="star1" name="rating" value="1">
                        <label for="star1">★</label>
                    </div>
                </div>
                <div class="form-group">
                    <label for="reviewText">Ulasan</label>
                    <textarea id="reviewText" class="form-control" placeholder="Bagikan pengalaman Anda..."></textarea>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-outline" onclick="closeModal('ratingModal')">Batal</button>
                    <button type="submit" class="btn btn-primary">Kirim Ulasan</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Leaflet JS for maps -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script>
        // Simulasi database user
        let usersDB = [];
        let currentUser = null; // {name, email, phone, password, role, avatar}

        // DATA DUMMY - Fokus di sekitar Pekanbaru
        let jobs = [
            {id: 1, title: "Bantuan Pindah Barang Kos", category: "moving", description: "Butuh bantuan pindah barang dari kosan ke apartemen baru. Barang tidak terlalu banyak, hanya 3 kardus dan 1 tas.", location: "Jl. Sudirman, Pekanbaru", price: 75000, date: "3 jam lalu", status: "open", emergency: false, distance: "1.2 km", favorite: false},
            {id: 2, title: "Antar ke Bandara Sultan Syarif Kasim II", category: "transport", description: "Butuh antar anggota keluarga ke bandara untuk penerbangan jam 10.00 WIB.", location: "Bandara SSK II, Pekanbaru", price: 120000, date: "1 jam lalu", status: "open", emergency: true, distance: "8.5 km", favorite: true},
            {id: 3, title: "Jaga Stand Pameran", category: "event", description: "Butuh helper untuk jaga stand pameran produk teknologi selama 4 jam. Akan ada briefing singkat sebelumnya.", location: "Jl. Tuanku Tambusai, Pekanbaru", price: 200000, date: "5 jam lalu", status: "open", emergency: false, distance: "3.2 km", favorite: false},
            {id: 4, title: "Bantu Kirim Paket ke Pelanggan", category: "delivery", description: "Perlu bantuan kirim paket dokumen ke kantor pelanggan di Jl. Diponegoro.", location: "Jl. Diponegoro, Pekanbaru", price: 50000, date: "2 hari lalu", status: "in-progress", emergency: false, distance: "4.0 km", favorite: false},
            {id: 5, title: "Selesai - Antar Jemput Anak Sekolah", category: "transport", description: "Butuh antar jemput anak sekolah selama 1 minggu.", location: "Jl. Nangka, Pekanbaru", price: 350000, date: "5 hari lalu", status: "completed", emergency: false, distance: "2.8 km", favorite: false},
            {id: 6, title: "Selesai - Pindahan Rumah", category: "moving", description: "Bantu angkat barang pindahan rumah ke alamat baru.", location: "Jl. Kaharuddin Nasution, Pekanbaru", price: 250000, date: "1 minggu lalu", status: "completed", emergency: false, distance: "5.0 km", favorite: false},
            {id: 7, title: "Perbaiki Kran Air Bocor", category: "tools", description: "Kran air bocor di dapur, butuh tukang untuk perbaikan.", location: "Jl. Yos Sudarso, Pekanbaru", price: 90000, date: "Baru saja", status: "open", emergency: false, distance: "0.8 km", favorite: false},
            {id: 8, title: "Bantu Pengepakan Barang", category: "moving", description: "Butuh bantuan mengepak barang rumah tangga untuk pindahan.", location: "Jl. Jend. Sudirman, Pekanbaru", price: 80000, date: "2 jam lalu", status: "open", emergency: false, distance: "1.5 km", favorite: false}
        ];
        let wallet = [
            {date:"2025-09-24", desc:"Pembayaran pekerjaan #5", amount: "+Rp 350.000", status:"Sukses"},
            {date:"2025-09-23", desc:"Top Up", amount: "+Rp 300.000", status:"Sukses"},
            {date:"2025-09-21", desc:"Pembayaran pekerjaan #6", amount: "+Rp 250.000", status:"Sukses"},
            {date:"2025-09-20", desc:"Tarik Saldo", amount: "-Rp 200.000", status:"Sukses"},
            {date:"2025-09-19", desc:"Pembayaran pekerjaan #2", amount: "+Rp 120.000", status:"Sukses"}
        ];
        let walletBalance = 1250000;
        let reviews = [
            {name:"Budi Santoso", avatar:"BS", rating:5, text:"Pelayanan cepat dan ramah. Terima kasih!", date:"2025-09-10"},
            {name:"Siti Rahma", avatar:"SR", rating:4, text:"Bekerja dengan baik, tepat waktu.", date:"2025-09-08"},
            {name:"Hendri", avatar:"H", rating:5, text:"Sangat membantu, recommended!", date:"2025-09-05"},
            {name:"Dewi", avatar:"D", rating:4, text:"Proses mudah dan hasil memuaskan.", date:"2025-08-30"}
        ];
        let favorites = [];
        let notifications = [
            {id: 1, title: "Pekerjaan Baru", message: "Ada pekerjaan pindahan di daerah Payung Sekaki", time: "5 menit lalu", read: false},
            {id: 2, title: "Pembayaran Diterima", message: "Pembayaran untuk pekerjaan #123 telah diterima", time: "1 jam lalu", read: false},
            {id: 3, title: "Rating Baru", message: "Anda mendapat rating 5 bintang dari Budi", time: "2 hari lalu", read: true}
        ];

        // Koordinat untuk peta Pekanbaru
        const pekanbaruCoords = [0.5071, 101.4478];

        // ========== Loading Animation ==========
        function showLoading(ms=1200) {
            document.getElementById('loadingBackdrop').style.display = 'flex';
            return new Promise(resolve=>{
                setTimeout(()=>{
                    document.getElementById('loadingBackdrop').style.display = 'none';
                    resolve();
                }, ms);
            });
        }

        // ========== Navigasi & Sidebar ==========
        document.querySelectorAll('.sidebar-link').forEach(link => {
            link.addEventListener('click', function(e){
                e.preventDefault();
                setActiveMenu(this.dataset.page);
                if(window.innerWidth<=992) toggleMobileMenu();
            });
        });
        document.querySelectorAll('.bottom-nav-item').forEach(link=>{
            link.addEventListener('click',function(e){
                e.preventDefault();
                setActiveMenu(this.dataset.page);
            });
        });
        function setActiveMenu(pageId){
            document.querySelectorAll('.sidebar-link').forEach(a=>a.classList.remove('active'));
            document.querySelectorAll('.bottom-nav-item').forEach(a=>a.classList.remove('active'));
            document.querySelectorAll('.page-main').forEach(p=>p.style.display='none');
            document.getElementById(pageId).style.display='block';
            document.querySelectorAll(`[data-page="${pageId}"]`).forEach(el=>el.classList.add('active'));
            
            // Sembunyikan halaman analitik jika user adalah requester
            if (currentUser && currentUser.role === 'requester' && pageId === 'analyticsPage') {
                document.getElementById('analyticsPage').style.display = 'none';
                setActiveMenu('homePage');
                alert('Halaman analitik hanya tersedia untuk Helper');
            }
        }
        setActiveMenu('homePage');
        document.querySelectorAll('.cat-link').forEach(link=>{
            link.addEventListener('click',function(e){
                e.preventDefault();
                document.getElementById('categoryFilter').value=this.dataset.cat;
                setActiveMenu('homePage');
                filterJobs();
            });
        });
        const mobileMenuBtn = document.getElementById('mobileMenuBtn');
        const sidebar = document.getElementById('sidebar');
        const mobileOverlay = document.getElementById('mobileOverlay');
        function toggleMobileMenu() {
            sidebar.classList.toggle('mobile-visible');
            mobileOverlay.style.display = sidebar.classList.contains('mobile-visible') ? 'block' : 'none';
            document.body.style.overflow = sidebar.classList.contains('mobile-visible') ? 'hidden' : 'auto';
        }
        mobileMenuBtn.addEventListener('click', toggleMobileMenu);
        mobileOverlay.addEventListener('click', toggleMobileMenu);
        document.querySelectorAll('.sidebar-menu a').forEach(item => {
            item.addEventListener('click', () => {
                if (window.innerWidth <= 992) toggleMobileMenu();
            });
        });

        // ========== Authentication ==========
        function switchAuthTab(tab) {
            document.querySelectorAll('.auth-tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.auth-form').forEach(f => f.classList.remove('active'));
            document.querySelector(`.auth-tab:nth-child(${tab === 'login' ? 1 : 2})`).classList.add('active');
            document.getElementById(`${tab}Form`).classList.add('active');
        }

        // Handle register (langsung masuk tanpa cek DB)
        document.getElementById('registerForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            showLoading();
            await showLoading();
            let name = document.getElementById('regName').value.trim();
            let email = document.getElementById('regEmail').value.trim().toLowerCase();
            let phone = document.getElementById('regPhone').value.trim();
            let password = document.getElementById('regPassword').value;
            let role = document.getElementById('userType').value;
            let avatar = name.split(' ').map(x=>x[0]).join('').substring(0,2).toUpperCase();
            let user = {name, email, phone, password, role, avatar};
            currentUser = user;
            afterLogin();
        });
        // Handle login (langsung masuk tanpa cek DB)
        document.getElementById('loginForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            showLoading();
            await showLoading();
            let email = document.getElementById('loginEmail').value.trim().toLowerCase();
            let password = document.getElementById('loginPassword').value;
            let name = email.split('@')[0] || email || "User";
            let avatar = name.split(' ').map(x=>x[0]).join('').substring(0,2).toUpperCase();
            let role = "requester";
            currentUser = {name, email, phone:'', password, role, avatar};
            afterLogin();
        });
       
        // Update profile info after login
        function afterLogin() {
            document.getElementById('authPage').classList.remove('active');
            document.getElementById('dashboardPage').classList.add('active');
            document.getElementById('profileName').textContent = currentUser.name;
            document.getElementById('profileAvatar').textContent = currentUser.avatar;
            // Set default role view (requester/helper)
            if(currentUser.role==="requester"){
                document.getElementById('requesterBtn').classList.add('active');
                document.getElementById('helperBtn').classList.remove('active');
                document.getElementById('requesterView').style.display = 'block';
                document.getElementById('helperView').style.display = 'none';
                
                // Sembunyikan menu analitik untuk requester
                document.querySelectorAll('.helper-only').forEach(el => {
                    el.style.display = 'none';
                });
            } else {
                document.getElementById('helperBtn').classList.add('active');
                document.getElementById('requesterBtn').classList.remove('active');
                document.getElementById('helperView').style.display = 'block';
                document.getElementById('requesterView').style.display = 'none';
                
                // Tampilkan menu analitik untuk helper
                document.querySelectorAll('.helper-only').forEach(el => {
                    el.style.display = 'flex';
                });
            }
            loadJobs();
            updateNotificationBadge();
        }

        function logout() {
            currentUser = null;
            document.getElementById('dashboardPage').classList.remove('active');
            document.getElementById('authPage').classList.add('active');
        }

        // Role Switch
        document.getElementById('requesterBtn').addEventListener('click', function() {
            document.getElementById('requesterView').style.display = 'block';
            document.getElementById('helperView').style.display = 'none';
            document.getElementById('requesterBtn').classList.add('active');
            document.getElementById('helperBtn').classList.remove('active');
            
            // Sembunyikan menu analitik untuk requester
            document.querySelectorAll('.helper-only').forEach(el => {
                el.style.display = 'none';
            });
            
            loadRequesterJobs();
        });
        document.getElementById('helperBtn').addEventListener('click', function() {
            document.getElementById('requesterView').style.display = 'none';
            document.getElementById('helperView').style.display = 'block';
            document.getElementById('helperBtn').classList.add('active');
            document.getElementById('requesterBtn').classList.remove('active');
            
            // Tampilkan menu analitik untuk helper
            document.querySelectorAll('.helper-only').forEach(el => {
                el.style.display = 'flex';
            });
            
            loadHelperJobs();
        });

        // ========== Modal ==========
        function openModal(modalId) {
            document.getElementById(modalId).style.display = 'flex';
            document.body.style.overflow = 'hidden';
        }
        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
            document.body.style.overflow = 'auto';
        }
        window.onclick = function(event) {
            if (event.target.classList.contains('modal')) {
                event.target.style.display = 'none';
                document.body.style.overflow = 'auto';
            }
        }

        // ========== Topup ==========
        let selectedTopupMethod = null;
        document.querySelectorAll('.topup-method').forEach(el=>{
            el.onclick = function(){
                document.querySelectorAll('.topup-method').forEach(m=>m.classList.remove('selected'));
                this.classList.add('selected');
                selectedTopupMethod = this.dataset.method;
                document.getElementById('topupVALIST').style.display = (selectedTopupMethod==='va')?'block':'none';
            }
        });
        document.getElementById('topupForm').addEventListener('submit', async function(e){
            e.preventDefault();
            if(!selectedTopupMethod){
                alert('Pilih metode top up!');
                return;
            }
            let nominal = parseInt(document.getElementById('topupNominal').value);
            if(isNaN(nominal) || nominal < 10000){
                alert('Minimal top up Rp 10.000');
                return;
            }
            let desc = "Top Up via ";
            if(selectedTopupMethod==='va'){
                let bank = document.getElementById('vaBank').value.toUpperCase();
                desc += "VA "+bank;
            } else if(selectedTopupMethod==='dana'){
                desc += "DANA";
            } else if(selectedTopupMethod==='shopeepay'){
                desc += "ShopeePay";
            } else if(selectedTopupMethod==='qris'){
                desc += "QRIS";
            }
            showLoading();
            await showLoading();
            walletBalance += nominal;
            wallet.unshift({date: (new Date()).toISOString().slice(0,10), desc, amount: "+Rp "+nominal.toLocaleString('id-ID'), status: 'Sukses'});
            closeModal('topupModal');
            loadWallet();
            alert('Top up berhasil! Dana akan segera masuk ke saldo Anda.');
        });

        // ========== Beranda (homePage) ==========
        document.getElementById('createJobForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const title = document.getElementById('jobTitle').value;
            const category = document.getElementById('jobCategory').value;
            const description = document.getElementById('jobDescription').value;
            const location = document.getElementById('jobLocation').value;
            let price = parseInt(document.getElementById('jobPrice').value);
            const emergency = document.getElementById('emergencyJob').checked;
            if (emergency) price = Math.round(price * 1.25);
            const newJob = {
                id: jobs.length + 1, title, category, description, location, price, date: "Baru saja",
                status: "open", emergency, distance: "0.5 km", favorite: false
            };
            jobs.unshift(newJob);
            loadRequesterJobs();
            alert('Permintaan bantuan berhasil dibuat!');
            closeModal('createJobModal');
            document.getElementById('createJobForm').reset();
        });

        function loadRequesterJobs() {
            const jobList = document.getElementById('requesterJobList');
            jobList.innerHTML = '';
            let filteredJobs = jobs;
            const statusFilter = document.getElementById('statusFilter').value;
            const catFilter = document.getElementById('categoryFilter').value;
            const sort = document.getElementById('sortFilter').value;
            if (statusFilter !== 'all') filteredJobs = filteredJobs.filter(job => job.status === statusFilter);
            if (catFilter !== 'all') filteredJobs = filteredJobs.filter(job => job.category === catFilter);
            if (sort === 'newest') filteredJobs = filteredJobs.slice().reverse();
            if (sort === 'oldest') filteredJobs = filteredJobs.slice();
            if (sort === 'price-high') filteredJobs = filteredJobs.slice().sort((a,b)=>b.price-a.price);
            if (sort === 'price-low') filteredJobs = filteredJobs.slice().sort((a,b)=>a.price-b.price);
            document.getElementById('activeJobsCount').textContent = filteredJobs.length;
            if (filteredJobs.length === 0) {
                jobList.innerHTML = `<div class="empty-state"><i class="fas fa-inbox"></i><h3>Tidak ada permintaan bantuan</h3><p>Belum ada permintaan bantuan yang dibuat. Buat permintaan pertama Anda!</p></div>`;
                return;
            }
            filteredJobs.forEach(job => {
                const jobCard = document.createElement('div');
                jobCard.className = `job-card ${job.emergency ? 'emergency' : ''}`;
                jobCard.innerHTML = `
                    ${job.emergency ? '<div class="emergency-badge">Emergency</div>' : ''}
                    <h3>${job.title}</h3>
                    <div class="job-meta">
                        <span><i class="fas fa-map-marker-alt"></i> ${job.location}</span>
                        <span><i class="far fa-clock"></i> ${job.date}</span>
                    </div>
                    <div class="job-price">Rp ${job.price.toLocaleString('id-ID')}</div>
                    <div class="job-description">${job.description}</div>
                    <div class="job-tags">
                        <span class="job-tag">${getCategoryName(job.category)}</span>
                        <span class="job-tag">${job.location.split(',')[0]}</span>
                        ${job.emergency ? '<span class="job-tag">Emergency</span>' : ''}
                    </div>
                    <div class="job-actions requester-actions">
                        <button class="btn btn-outline" onclick="viewJobDetail(${job.id})">Lihat Detail</button>
                        <button class="btn btn-primary" onclick="editJob(${job.id})">Edit</button>
                        <button class="favorite-btn ${job.favorite ? 'active' : ''}" onclick="toggleFavorite(${job.id})">
                            <i class="${job.favorite ? 'fas' : 'far'} fa-heart"></i>
                        </button>
                    </div>
                `;
                jobList.appendChild(jobCard);
            });
        }
        function loadHelperJobs() {
            const jobList = document.getElementById('helperJobList');
            jobList.innerHTML = '';
            let openJobs = jobs.filter(job => job.status === 'open');
            const cat = document.getElementById('helperCategoryFilter').value;
            const dist = document.getElementById('distanceFilter').value;
            const sort = document.getElementById('helperSortFilter').value;
            if (cat !== 'all') openJobs = openJobs.filter(job=>job.category===cat);
            if (dist!=='all') {
                let maxDist = parseInt(dist.replace('km',''));
                openJobs = openJobs.filter(job=>parseFloat(job.distance) <= maxDist);
            }
            if (sort==='newest') openJobs=openJobs.slice().reverse();
            if (sort==='price-high') openJobs=openJobs.slice().sort((a,b)=>b.price-a.price);
            if (sort==='price-low') openJobs=openJobs.slice().sort((a,b)=>a.price-b.price);
            if (sort==='distance') openJobs=openJobs.slice().sort((a,b)=>parseFloat(a.distance)-parseFloat(b.distance));
            if (openJobs.length === 0) {
                jobList.innerHTML = `<div class="empty-state"><i class="fas fa-search"></i><h3>Tidak ada pekerjaan tersedia</h3><p>Saat ini tidak ada pekerjaan yang tersedia di sekitar Anda.</p></div>`;
                return;
            }
            openJobs.forEach(job => {
                const jobCard = document.createElement('div');
                jobCard.className = `job-card ${job.emergency ? 'emergency' : ''}`;
                jobCard.innerHTML = `
                    ${job.emergency ? '<div class="emergency-badge">Emergency</div>' : ''}
                    <h3>${job.title}</h3>
                    <div class="job-meta">
                        <span><i class="fas fa-map-marker-alt"></i> ${job.distance}</span>
                        <span><i class="far fa-clock"></i> ${job.date}</span>
                    </div>
                    <div class="job-price">Rp ${job.price.toLocaleString('id-ID')}</div>
                    <div class="job-description">${job.description}</div>
                    <div class="job-tags">
                        <span class="job-tag">${getCategoryName(job.category)}</span>
                        <span class="job-tag">${job.location.split(',')[0]}</span>
                        ${job.emergency ? '<span class="job-tag">Emergency</span>' : ''}
                    </div>
                    <button class="btn btn-primary" onclick="takeJob(${job.id})">Ambil Pekerjaan</button>
                    <button class="favorite-btn ${job.favorite ? 'active' : ''}" onclick="toggleFavorite(${job.id})" style="margin-top:10px;">
                        <i class="${job.favorite ? 'fas' : 'far'} fa-heart"></i> ${job.favorite ? 'Favorit' : 'Tambahkan ke Favorit'}
                    </button>
                `;
                jobList.appendChild(jobCard);
            });
        }
        function viewJobDetail(jobId) {
            const job = jobs.find(j => j.id === jobId);
            if (!job) return;
            document.getElementById('detailJobTitle').textContent = job.title;
            document.getElementById('detailJobCategory').textContent = getCategoryName(job.category);
            document.getElementById('detailJobLocation').textContent = job.location;
            document.getElementById('detailJobPrice').textContent = `Rp ${job.price.toLocaleString('id-ID')}`;
            document.getElementById('detailJobDescription').textContent = job.description;
            document.getElementById('detailJobDate').textContent = job.date;
            document.getElementById('detailJobStatus').textContent = getStatusName(job.status);
            document.getElementById('detailJobBadge').innerHTML = job.emergency ? '<div class="emergency-badge">Emergency</div>' : '';
            
            // Initialize map dengan fokus di Pekanbaru
            const mapContainer = document.getElementById('detailJobMap');
            mapContainer.innerHTML = '<div id="jobMap" style="height:100%;"></div>';
            
            setTimeout(() => {
                const map = L.map('jobMap').setView(pekanbaruCoords, 12);
                L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                    attribution: '© OpenStreetMap contributors'
                }).addTo(map);
                
                // Add a marker untuk lokasi pekerjaan (dalam demo, kita gunakan koordinat acak di sekitar Pekanbaru)
                const randomOffset = () => (Math.random() - 0.5) * 0.1;
                const jobCoords = [pekanbaruCoords[0] + randomOffset(), pekanbaruCoords[1] + randomOffset()];
                
                L.marker(jobCoords).addTo(map)
                    .bindPopup(job.location)
                    .openPopup();
            }, 100);
            
            const actionBtn = document.getElementById('detailActionBtn');
            const favoriteBtn = document.getElementById('detailFavoriteBtn');
            
            // Tentukan tampilan berdasarkan role user
            if (document.getElementById('requesterView').style.display !== 'none') {
                // Requester view - bisa edit
                actionBtn.textContent = 'Edit';
                actionBtn.onclick = function() { editJob(jobId); };
                actionBtn.style.display = "inline-block";
            } else {
                // Helper view - tidak bisa edit, hanya ambil pekerjaan
                actionBtn.textContent = 'Ambil Pekerjaan';
                actionBtn.onclick = function() { takeJob(jobId); };
                actionBtn.style.display = "inline-block";
            }
            
            favoriteBtn.innerHTML = job.favorite ? '<i class="fas fa-heart"></i>' : '<i class="far fa-heart"></i>';
            favoriteBtn.className = `btn btn-outline favorite-btn ${job.favorite ? 'active' : ''}`;
            favoriteBtn.onclick = function() { toggleFavorite(jobId); };
            favoriteBtn.style.display = "inline-block";
            
            openModal('jobDetailModal');
        }
        function takeJob(jobId) {
            const job = jobs.find(j => j.id === jobId);
            if (!job) return;
            if (confirm(`Apakah Anda yakin ingin mengambil pekerjaan "${job.title}"?`)) {
                job.status = 'in-progress';
                alert(`Anda berhasil mengambil pekerjaan "${job.title}"!`);
                loadRequesterJobs();
                loadHelperJobs();
                closeModal('jobDetailModal');
                loadMyJobs();
            }
        }
        function editJob(jobId) {
            // Helper tidak bisa mengedit pekerjaan
            if (currentUser && currentUser.role === 'helper') {
                alert('Maaf, Helper tidak dapat mengedit pekerjaan. Fitur ini hanya tersedia untuk Requester.');
                return;
            }
            
            const job = jobs.find(j => j.id === jobId);
            if (!job) return;
            alert(`Fitur edit untuk pekerjaan "${job.title}" akan segera tersedia!`);
            closeModal('jobDetailModal');
        }
        function filterJobs() { loadRequesterJobs(); }
        function filterHelperJobs() { loadHelperJobs(); }
        function getCategoryName(category) {
            const categories = { 'moving': 'Pindahan', 'delivery': 'Pengiriman', 'transport': 'Antar Jemput', 'event': 'Jaga Acara', 'other': 'Lainnya', 'tools':'Perbaikan' };
            return categories[category] || category;
        }
        function getStatusName(status) {
            const statuses = { 'open': 'Terbuka', 'in-progress': 'Dalam Proses', 'completed': 'Selesai' };
            return statuses[status] || status;
        }
        function loadJobs() {
            loadRequesterJobs();
            loadHelperJobs();
            loadMyJobs();
            loadWallet();
            loadReviews();
            loadHistory();
            loadFavorites();
        }
        window.addEventListener('resize', function() {
            if (window.innerWidth > 992) {
                sidebar.classList.remove('mobile-visible');
                mobileOverlay.style.display = 'none';
                document.body.style.overflow = 'auto';
            }
        });
        
        // ========== Pekerjaan Saya ==========
        function loadMyJobs() {
            let active = jobs.filter(j=>j.status==='open' || j.status==='in-progress');
            let complete = jobs.filter(j=>j.status==='completed');
            let q1 = (document.getElementById('myJobSearch')||{value:""}).value.toLowerCase();
            let q2 = (document.getElementById('myJobDoneSearch')||{value:""}).value.toLowerCase();
            if (q1) active = active.filter(j=>j.title.toLowerCase().includes(q1));
            if (q2) complete = complete.filter(j=>j.title.toLowerCase().includes(q2));
            let activeDiv = document.getElementById('activeJobList');
            activeDiv.innerHTML = '';
            if (active.length === 0) activeDiv.innerHTML = `<div class="empty-state"><i class="fas fa-briefcase"></i><h3>Belum ada pekerjaan aktif</h3></div>`;
            active.forEach(job=>{
                let card = document.createElement('div');
                card.className = 'job-card';
                card.innerHTML = `
                    <h3>${job.title}</h3>
                    <div class="job-meta">
                        <span><i class="fas fa-map-marker-alt"></i> ${job.location}</span>
                        <span><i class="far fa-clock"></i> ${job.date}</span>
                    </div>
                    <div class="job-price">Rp ${job.price.toLocaleString('id-ID')}</div>
                    <div class="job-description">${job.description}</div>
                    <div class="job-tags">
                        <span class="job-tag">${getCategoryName(job.category)}</span>
                        <span class="job-tag">${getStatusName(job.status)}</span>
                    </div>
                    <div class="job-actions requester-actions">
                        <button class="btn btn-outline" onclick="viewJobDetail(${job.id})">Lihat Detail</button>
                        ${currentUser && currentUser.role === 'requester' ? 
                            '<button class="btn btn-primary" onclick="editJob(' + job.id + ')">Edit</button>' : 
                            '<button class="btn btn-primary" onclick="completeJob(' + job.id + ')">Selesaikan</button>'
                        }
                        <button class="favorite-btn ${job.favorite ? 'active' : ''}" onclick="toggleFavorite(${job.id})">
                            <i class="${job.favorite ? 'fas' : 'far'} fa-heart"></i>
                        </button>
                    </div>
                `;
                activeDiv.appendChild(card);
            });
            let compDiv = document.getElementById('completedJobList');
            compDiv.innerHTML = '';
            if (complete.length === 0) compDiv.innerHTML = `<div class="empty-state"><i class="fas fa-check-circle"></i><h3>Belum ada pekerjaan selesai</h3></div>`;
            complete.forEach(job=>{
                let card = document.createElement('div');
                card.className = 'job-card';
                card.innerHTML = `
                    <h3>${job.title}</h3>
                    <div class="job-meta">
                        <span><i class="fas fa-map-marker-alt"></i> ${job.location}</span>
                        <span><i class="far fa-clock"></i> ${job.date}</span>
                    </div>
                    <div class="job-price">Rp ${job.price.toLocaleString('id-ID')}</div>
                    <div class="job-description">${job.description}</div>
                    <div class="job-tags">
                        <span class="job-tag">${getCategoryName(job.category)}</span>
                        <span class="job-tag">${getStatusName(job.status)}</span>
                    </div>
                    <div class="job-actions requester-actions">
                        <button class="btn btn-outline" onclick="viewJobDetail(${job.id})">Lihat Detail</button>
                        <button class="btn btn-primary" onclick="giveRating(${job.id})">Beri Rating</button>
                    </div>
                `;
                compDiv.appendChild(card);
            });
        }
        function filterMyJobs() { loadMyJobs(); }
        function switchTab(tabId, el){
            document.querySelectorAll('.tab-page').forEach(tab=>tab.style.display='none');
            document.getElementById(tabId).style.display='block';
            document.querySelectorAll('.tabbed-btn').forEach(btn=>btn.classList.remove('active'));
            el.classList.add('active');
        }
        function completeJob(jobId){
            let job = jobs.find(j=>j.id===jobId);
            if(!job) return;
            job.status = 'completed';
            alert('Pekerjaan telah ditandai selesai!');
            loadMyJobs();
            loadRequesterJobs();
            loadHistory();
        }
        function giveRating(jobId){
            let job = jobs.find(j=>j.id===jobId);
            if(!job) return;
            openModal('ratingModal');
            // In a real app, you would submit the rating to the server
            document.getElementById('ratingForm').onsubmit = function(e) {
                e.preventDefault();
                const rating = document.querySelector('input[name="rating"]:checked');
                const reviewText = document.getElementById('reviewText').value;
                if (!rating) {
                    alert('Pilih rating terlebih dahulu!');
                    return;
                }
                alert('Terima kasih atas rating dan ulasan Anda!');
                closeModal('ratingModal');
            };
        }
        
        // ========== Favorit ==========
        function toggleFavorite(jobId) {
            const job = jobs.find(j => j.id === jobId);
            if (!job) return;
            job.favorite = !job.favorite;
            if (job.favorite) {
                favorites.push(jobId);
            } else {
                favorites = favorites.filter(id => id !== jobId);
            }
            loadRequesterJobs();
            loadHelperJobs();
            loadMyJobs();
            loadFavorites();
        }
        function loadFavorites() {
            const favoritesList = document.getElementById('favoriteJobList');
            favoritesList.innerHTML = '';
            const favoriteJobs = jobs.filter(job => job.favorite);
            if (favoriteJobs.length === 0) {
                favoritesList.innerHTML = `<div class="empty-state"><i class="fas fa-heart"></i><h3>Belum ada pekerjaan favorit</h3><p>Simpan pekerjaan yang menarik dengan menekan ikon hati pada kartu pekerjaan.</p></div>`;
                return;
            }
            favoriteJobs.forEach(job => {
                const jobCard = document.createElement('div');
                jobCard.className = 'job-card';
                jobCard.innerHTML = `
                    <h3>${job.title}</h3>
                    <div class="job-meta">
                        <span><i class="fas fa-map-marker-alt"></i> ${job.location}</span>
                        <span><i class="far fa-clock"></i> ${job.date}</span>
                    </div>
                    <div class="job-price">Rp ${job.price.toLocaleString('id-ID')}</div>
                    <div class="job-description">${job.description}</div>
                    <div class="job-tags">
                        <span class="job-tag">${getCategoryName(job.category)}</span>
                        <span class="job-tag">${getStatusName(job.status)}</span>
                    </div>
                    <div class="job-actions requester-actions">
                        <button class="btn btn-outline" onclick="viewJobDetail(${job.id})">Lihat Detail</button>
                        <button class="favorite-btn active" onclick="toggleFavorite(${job.id})">
                            <i class="fas fa-heart"></i> Hapus dari Favorit
                        </button>
                    </div>
                `;
                favoritesList.appendChild(jobCard);
            });
        }
        
        // ========== Dompet ==========
        function loadWallet(){
            document.getElementById('walletBalance').textContent = "Rp "+walletBalance.toLocaleString('id-ID');
            let e = document.getElementById('walletHistory');
            e.innerHTML = '';
            wallet.forEach(wal=>{
                let row = document.createElement('tr');
                row.innerHTML = `<td style="padding:8px 6px;">${wal.date}</td><td>${wal.desc}</td><td style="text-align:right;">${wal.amount}</td><td style="text-align:right;font-weight:600;color:${wal.amount.startsWith('+')?'var(--success)':'var(--danger)'}">${wal.status}</td>`;
                e.appendChild(row);
            });
        }
        
        // ========== Ulasan ==========
        function loadReviews(){
            let e = document.getElementById('reviewList');
            e.innerHTML = '';
            reviews.forEach(r=>{
                let div = document.createElement('div');
                div.style="display:flex;align-items:flex-start;margin-bottom:18px;";
                div.innerHTML = `
                    <div class="avatar" style="margin-right:12px;">${r.avatar}</div>
                    <div>
                        <div style="font-weight:600;font-size:1rem;">${r.name} <span style="color:var(--gray);font-size:0.9rem;font-weight:400;">(${r.date})</span></div>
                        <div style="color:orange;margin-bottom:5px;">${'★'.repeat(r.rating)}${'☆'.repeat(5-r.rating)}</div>
                        <div>${r.text}</div>
                    </div>
                `;
                e.appendChild(div);
            });
        }
        
        // ========== Riwayat ==========
        function loadHistory(){
            let e = document.getElementById('historyList');
            let q = (document.getElementById('historySearch')||{value:""}).value.toLowerCase();
            let sort = (document.getElementById('historySort')||{value:'newest'}).value;
            let hist = jobs.filter(j=>j.status==='completed');
            if(q) hist = hist.filter(j=>j.title.toLowerCase().includes(q)||j.location.toLowerCase().includes(q));
            if(sort==='newest') hist=hist.slice().reverse();
            if(sort==='oldest') hist=hist.slice();
            if(sort==='price-high') hist=hist.slice().sort((a,b)=>b.price-a.price);
            if(sort==='price-low') hist=hist.slice().sort((a,b)=>a.price-b.price);
            e.innerHTML = '';
            if(hist.length===0){
                e.innerHTML = `<div class="empty-state"><i class="fas fa-history"></i><h3>Belum ada histori pekerjaan</h3></div>`;
                return;
            }
            hist.forEach(job=>{
                let card = document.createElement('div');
                card.className = 'job-card';
                card.innerHTML = `
                    <h3>${job.title}</h3>
                    <div class="job-meta">
                        <span><i class="fas fa-map-marker-alt"></i> ${job.location}</span>
                        <span><i class="far fa-clock"></i> ${job.date}</span>
                    </div>
                    <div class="job-price">Rp ${job.price.toLocaleString('id-ID')}</div>
                    <div class="job-description">${job.description}</div>
                    <div class="job-tags">
                        <span class="job-tag">${getCategoryName(job.category)}</span>
                        <span class="job-tag">Selesai</span>
                    </div>
                    <div class="job-actions requester-actions">
                        <button class="btn btn-outline" onclick="viewJobDetail(${job.id})">Lihat Detail</button>
                    </div>
                `;
                e.appendChild(card);
            });
        }
        function filterHistory(){ loadHistory(); }
        
        // ========== Notifikasi ==========
        function updateNotificationBadge() {
            const unreadCount = notifications.filter(n => !n.read).length;
            const badge = document.getElementById('notificationBadge');
            if (unreadCount > 0) {
                badge.textContent = unreadCount;
                badge.style.display = 'flex';
            } else {
                badge.style.display = 'none';
            }
            
            // Update notification count in sidebar
            document.querySelectorAll('.notification-badge').forEach(badge => {
                if (unreadCount > 0) {
                    badge.textContent = unreadCount;
                    badge.style.display = 'flex';
                } else {
                    badge.style.display = 'none';
                }
            });
        }
        
        // Toggle notification dropdown
        document.getElementById('notificationIcon').addEventListener('click', function(e) {
            e.stopPropagation();
            const dropdown = document.getElementById('notificationDropdown');
            dropdown.style.display = dropdown.style.display === 'block' ? 'none' : 'block';
            
            // Mark notifications as read when dropdown is opened
            if (dropdown.style.display === 'block') {
                notifications.forEach(n => n.read = true);
                updateNotificationBadge();
            }
        });
        
        // Close dropdown when clicking outside
        document.addEventListener('click', function() {
            document.getElementById('notificationDropdown').style.display = 'none';
        });
        
        // ========== Referral ==========
        function copyReferralCode() {
            const code = "HENDI123";
            navigator.clipboard.writeText(code).then(function() {
                alert('Kode referral berhasil disalin: ' + code);
            }, function(err) {
                console.error('Gagal menyalin kode: ', err);
                alert('Gagal menyalin kode referral');
            });
        }
        
        // ========== Dark Mode ==========
        function toggleDarkMode() {
            document.body.classList.toggle('dark-mode');
            const darkModeToggle = document.getElementById('darkModeToggle');
            if (darkModeToggle) {
                darkModeToggle.checked = document.body.classList.contains('dark-mode');
            }
            // Save preference to localStorage
            localStorage.setItem('darkMode', document.body.classList.contains('dark-mode'));
            
            // Update dark mode toggle button icon
            const darkModeIcon = document.querySelector('.dark-mode-toggle i');
            if (document.body.classList.contains('dark-mode')) {
                darkModeIcon.className = 'fas fa-sun';
            } else {
                darkModeIcon.className = 'fas fa-moon';
            }
        }
        
        // Check for saved dark mode preference
        if (localStorage.getItem('darkMode') === 'true') {
            document.body.classList.add('dark-mode');
            const darkModeToggle = document.getElementById('darkModeToggle');
            if (darkModeToggle) {
                darkModeToggle.checked = true;
            }
            // Update dark mode toggle button icon
            const darkModeIcon = document.querySelector('.dark-mode-toggle i');
            darkModeIcon.className = 'fas fa-sun';
        }
        
        // ========== Init ==========
        loadJobs();
        updateNotificationBadge();
        
        // Add dark-mode-bg class to elements that need specific dark mode styling
        document.querySelectorAll('.dark-mode-bg').forEach(el => {
            if (document.body.classList.contains('dark-mode')) {
                el.style.background = '#252540';
                el.style.color = '#f0f0f0';
            }
        });
    </script>
</body>
</html>
